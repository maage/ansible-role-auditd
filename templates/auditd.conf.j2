{{ ansible_managed | comment }}
{% macro render_option(key, value, upper, default) %}
{%   if value is defined and value != None %}
{%     if value is sameas true %}
{{ key }} yes
{%     elif value is sameas false %}
{{ key }} no
{%     elif value is string and upper and auditd_use_upper_values %}
{{ key }} = {{ value|upper }}
{%     else %}
{{ key }} = {{ value }}
{%     endif %}
{%   else %}
{%     if default is defined %}
##{{ key }} = {{ default }}
{%     endif %}
{%   endif %}
{% endmacro %}

local_events = {{ auditd_local_events }}
write_logs = {{ auditd_write_logs }}
log_file = {{ auditd_log_file }}
log_group = {{ auditd_log_group }}
log_format = {{ auditd_log_format }}
flush = {{ auditd_flush }}
freq = {{ auditd_freq }}
max_log_file = {{ auditd_max_log_file }}
num_logs = {{ auditd_num_logs }}
priority_boost = {{ auditd_priority_boost }}
{{ render_option('disp_qos', auditd_disp_qos, 1) -}}
{{ render_option('dispatcher', auditd_dispatcher, 1) -}}
name_format = {{ auditd_name_format }}
{{ render_option('name', auditd_name, 0, 'mydomain') -}}
max_log_file_action = {{ auditd_max_log_file_action }}
space_left = {{ auditd_space_left }}
space_left_action = {{ auditd_space_left_action }}
verify_email = {{ auditd_verify_email }}
action_mail_acct = {{ auditd_action_mail_acct }}
admin_space_left = {{ auditd_admin_space_left }}
admin_space_left_action = {{ auditd_admin_space_left_action }}
disk_full_action = {{ auditd_disk_full_action }}
disk_error_action = {{ auditd_disk_error_action }}
use_libwrap = {{ auditd_use_libwrap }}
{{ render_option('tcp_listen_port', auditd_tcp_listen_port, 0, 60) -}}
tcp_listen_queue = {{ auditd_tcp_listen_queue }}
tcp_max_per_addr = {{ auditd_tcp_max_per_addr }}
{{ render_option('tcp_client_ports', auditd_tcp_client_ports, 0, '1024-65535') -}}
tcp_client_max_idle = {{ auditd_tcp_client_max_idle }}
{{ render_option('transport', auditd_transport, 1) -}}
{{ render_option('enable_krb5', auditd_enable_krb5, 1) -}}
krb5_principal = {{ auditd_krb5_principal }}
{{ render_option('krb5_key_file', auditd_krb5_key_file, 0, '/etc/audit/audit.key') -}}
distribute_network = {{ auditd_distribute_network }}
q_depth = {{ auditd_q_depth }}
overflow_action = {{ auditd_overflow_action }}
max_restarts = {{ auditd_max_restarts }}
